<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather Dashboard</title>
    <link rel="stylesheet" href="assets/style/style.css">
</head>

<body>
    <header>
        <h1>Weather Dashboard</h1>
    </header>
    <div class="container">

        <main>
            <div class="city-display">
                <h2 class="name">City</h2>
                <p class="temp">Temperature: </p>
                <p class="humid">Humidity: </p>
                <p class="wind"> Wind Speed: </p>
                <p class="uv-index">UV Index:<span id="uv"></span></p>
            </div>
            <div class="five-day">
                <h3>5-day Forecast: </h3>
            </div>
        </main>
        <aside>
            <div class="search">
                <h3>Search for a City:</h3>
                <form id="city-form">
                    <input id="city-input" type="search" aria-label="Search">
                    <button id="search-btn" type="submit"><img src="assets/images/search-white-27x27.png"></button>
                </form>
            </div>
            <div class="button-list">
                <button class="city" data-name="Austin">Austin</button><br>
                <button class="city" data-name="Houston">Houston</button>
                <button class="city" data-name="Chicago">Chicago</button><br>
                <button class="city" data-name="New York">New York</button>
                <button class="city" data-name="Orlando">Orlando</button>
                <button class="city" data-name="Los Angeles">Los Angeles</button>
                
            </div>

        </aside>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <script type="text/javascript">
            var cities = [];
            
            var date = ([new Date().getMonth() + 1] + "/" + [new Date().getDay()] + "/" + [new Date().getFullYear()]);
            function displayCityInfo() {
                $('.city-display').empty();
                var city = $(this).attr("data-name");
                var queryURL = "https://api.openweathermap.org/data/2.5/weather?q=" + city + "&appid=b406b96ea8ac39d55397323d0de502dd";
                
                // creates AJAX call for particular city button being clicked
                $.ajax({
                    url: queryURL,
                    method: "GET"

                }).then(function(response) {
                    console.log(response);

                    // convert temperature Kelvin to Fahrenheit
                    var tempF = (response.main.temp - 273.15) * 1.80 + 32;
                    var icon = response.weather[0].icon;
                    var iconURL = "https://openweathermap.org/img/wn/" + icon + "@2x.png"
                    // still need to access UV index (use another API from openweather API?)

                    var cityHtml = `
                    <section>
                        <h2>${response.name} ${date}  <img src="${iconURL}" alt="weather icon"></h2>
                            <p>Temperature: ${tempF.toFixed(2)}&deg F</p>
                            <p>Humidity: ${response.main.humidity}%</p>
                            <p> Wind Speed: ${response.wind.speed} mph</p>
                            <p>UV Index:<span id="uv"></span></p>


                    `
                    $('.city-display').append(cityHtml);
                    

                    
                    
                    // var iconURL = "https://openweathermap.org/img/wn/" + icon + "@2x.png"

                })
            }
            // ${response.weather.icon}
            // function that will display buttons for cities user has searched for
            function renderButtons() {
                // $('.button-list').empty();
                // console.log(response);
                for (var i = 0; i < cities.length; i++){
                    var c = $("<button>");
                    c.addClass("city");
                    c.attr("data-name", cities[i]);
                    c.text(cities[i]);
                    $(".button-list").append(c);
                }
            }


            
            $('#search-btn').on("click", function(event){
                event.preventDefault();
                
                // creating a variable named city, assigning text value to it
                var city = $("#city-input").val().trim();
                if (city !== null && city !== ""){
                    // logging city to console
                    console.log(city);

                    // add city currently in textbox to the array cities
                    cities.push(city);
                }
                displayCityInfo();
            })

            $(document).on("click", ".city", displayCityInfo);

            renderButtons();
            // GIVEN a weather dashboard with form inputs
            // WHEN I search for a city
            // THEN I am presented with current and future conditions for that city and that city is added to the search history
            // WHEN I view current weather conditions for that city
            // THEN I am presented with the city name, the date, an icon representation of weather conditions, the temperature, the humidity, the wind speed, and the UV index
            // WHEN I view the UV index
            // THEN I am presented with a color that indicates whether the conditions are favorable, moderate, or severe
            // WHEN I view future weather conditions for that city
            // THEN I am presented with a 5-day forecast that displays the date, an icon representation of weather conditions, the temperature, and the humidity
            // WHEN I click on a city in the search history
            // THEN I am again presented with current and future conditions for that city
            // WHEN I open the weather dashboard
            // THEN I am presented with the last searched city forecast
        </script>
    </div>
</body>

</html>